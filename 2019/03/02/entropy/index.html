<!DOCTYPE html>
<html lang="" class=""><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>
    
      机器学习基础知识：熵，交叉熵，相对熵
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/css/main.css" />
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/han-css@3/dist/han.min.css">
</head>
<body a="auto">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">..</a>

<article>
    <p class="post-meta">
        <time datetime="2019-03-02 16:02:21 &#43;0000 UTC">
            2019-03-02
        </time>
    </p>

    <h1>机器学习基础知识：熵，交叉熵，相对熵</h1>

    <h3 id="简介">简介</h3>
<p>信息熵是随机数据源产生信息的均量。信息熵代表的是随机变量或整个系统的不确定性，熵越大，随机变量或系统的不确定性就越大。</p>
<h3 id="计算">计算</h3>
<p>一枚正常硬币进行若干次抛投，这个事件的熵是1bit，因为结果不外乎两个 - 正面或反面，可以表示为0，1编码，而且两个结果彼此之间相互独立。但如果一枚硬币的两面完全相同，那抛硬币事件的熵为零，因为结果能被准确预测。</p>
<h3 id="定义">定义</h3>
<p>信息熵的数学公式如下：</p>
<p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ad96d27b76b011b9cb7c41665e3e25edf04b3515" alt="entropy definition"></p>
<p>其中 P 为X的概率质量函数，E为期望函数，而I(x)是X的信息量。I(X)本身是个随机变数。当取自有限样本时，熵的公式可以表示为：</p>
<p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/67841ec4b4f7e6ab658842ef2f53add46a2debbd" alt="entropy deinition2"></p>
<p>所以熵的本质是香农信息量 log(1/p)的期望；一个事件结果的出现概率越低，对其编码的bit长度就越长。以期望在整个随机事件的无数次重复试验中，用最少的bit去记录整个实验历史，即无法压缩的表达，代表了真正的信息量。</p>
<h3 id="交叉熵">交叉熵</h3>
<p>一个系统有一个真实的概率分布，也叫真实分布，根据真实分布，我们能够找到一个最优策略，以最小的代价消除系统的不确定性，而这个代价大小就是信息熵。</p>
<p>多数情况下，我们并不知道系统的真实分布，如抛硬币例子，如果硬币两面一样，但我们不知道这一信息，以为两面不一样，两面不一样是一个非真实分布。<strong>交叉熵</strong>，是用来衡量在给定的真实分布下，使用非真实分布所指定的策略消除系统的不确定性所需要付出的努力大小。</p>
<p>交叉熵的公式为：</p>
<p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0cb6da032ab424eefdca0884cd4113fe578f4293" alt="cross_entropy"></p>
<p>其中p为真实分布，q为非真实分布。交叉熵越低，意味着q越接近p。所以在机器学习分类算法中，我们总是最小化交叉熵，交叉熵越低，间接证明算法推算出的非真实分布q越接近真实分布p。</p>
<p>深度学习中交叉熵损失函数[Cross Entropy Loss]；</p>
<p><img src="https://www.zhihu.com/equation?tex=L%3D-%5Bylog%5C+%5Chat+y%2B%281-y%29log%5C+%281-%5Chat+y%29%5D" alt="cross entropy loss"></p>
<h3 id="相对熵kl散度">相对熵（KL散度）</h3>
<p>相对熵又称KL散度，是为了衡量不同策略之间的差异，即：</p>
<p><img src="https://www.zhihu.com/equation?tex=%5Csum_%7B+x+%5Cin+X%7D+f%28x%29+%2A+%5Clog_2+%5Cfrac%7Bf%28x%29%7D%7Bg%28x%29%7D" alt=""></p>
<p>假设f(x)为真实分布p，g(x)为非真实分布q，则上述相对熵为：</p>
<p><img src="https://www.zhihu.com/equation?tex=+%5Csum_%7Bk%3D1%7D%5EN+p_k+%5Clog_2+%5Cfrac%7B1%7D%7Bq_k%7D+-+%5Csum_%7Bk%3D1%7D%5EN+p_k+%5Clog_2+%5Cfrac%7B1%7D%7Bp_k%7D+%3D+%5Csum_%7Bk%3D1%7D%5EN+p_k+%5Clog_2+%5Cfrac%7Bp_k%7D%7Bq_k%7D" alt=""></p>

</article>

            </div>
        </main>
	<script src="https://cdn.jsdelivr.net/npm/han-css@3/dist/han.min.js"></script>
    </body>
</html>
